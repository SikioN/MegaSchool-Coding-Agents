# ‚òÅÔ∏è –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Yandex Cloud (Serverless)

–≠—Ç–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∞–≥–µ–Ω—Ç–∞ –≤ –æ–±–ª–∞–∫–µ –Ø–Ω–¥–µ–∫—Å, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å **–ø—É–±–ª–∏—á–Ω—ã–π HTTPS –∞–¥—Ä–µ—Å** (–±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ngrok) –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ä–∞–±–æ—Ç—É 24/7.

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1.  **–ê–∫–∫–∞—É–Ω—Ç –≤ Yandex Cloud**: [–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è](https://console.cloud.yandex.ru/).
2.  **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π CLI (`yc`)**:
    *   [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ](https://cloud.yandex.ru/docs/cli/quickstart).
    *   –õ–∏–±–æ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞—á–∞–π—Ç–µ –±–∏–Ω–∞—Ä–Ω–∏–∫ –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH.
3.  **Docker**: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –ª–æ–∫–∞–ª—å–Ω–æ.

---

## üöÄ –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è Yandex Cloud

–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é (–≤–∞—Å –ø–æ–ø—Ä–æ—Å—è—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –≤ –±—Ä–∞—É–∑–µ—Ä–µ)
yc init

# 2. –í—ã–±–µ—Ä–∏—Ç–µ –æ–±–ª–∞–∫–æ –∏ –ø–∞–ø–∫—É (–∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é 'megaschool-agent')
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ –†–µ–µ—Å—Ç—Ä–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ (Container Registry)

–ù–∞–º –Ω—É–∂–Ω–æ –º–µ—Å—Ç–æ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è Docker-–æ–±—Ä–∞–∑–æ–≤.

```bash
# –°–æ–∑–¥–∞–µ–º —Ä–µ–µ—Å—Ç—Ä —Å –∏–º–µ–Ω–µ–º 'agent-registry'
yc container registry create --name agent-registry

# –ü–æ–ª—É—á–∞–µ–º ID —Ä–µ–µ—Å—Ç—Ä–∞ (–∑–∞–ø–∏—à–∏—Ç–µ –µ–≥–æ!)
yc container registry get agent-registry
# –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞: id: crp123456789...
```

**–í–∞–∂–Ω–æ**: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Docker –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–µ—Å—Ç—Ä–æ–º –Ø–Ω–¥–µ–∫—Å–∞:
```bash
yc container registry configure-docker
```

### –®–∞–≥ 3: –°–±–æ—Ä–∫–∞ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ–±—Ä–∞–∑–∞

–ó–∞–º–µ–Ω–∏—Ç–µ `REGISTRY_ID` –Ω–∞ –≤–∞—à ID –∏–∑ —à–∞–≥–∞ 2.

```bash
export REGISTRY_ID=crp... (–≤–∞—à–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

# 1. –°–æ–±–∏—Ä–∞–µ–º –æ–±—Ä–∞–∑ (—É–∫–∞–∑—ã–≤–∞–µ–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—É linux/amd64 –¥–ª—è –æ–±–ª–∞–∫–∞)
docker build --platform linux/amd64 -t cr.yandex/$REGISTRY_ID/agent:latest .

# 2. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –æ–±–ª–∞–∫–æ
docker push cr.yandex/$REGISTRY_ID/agent:latest
```

### –®–∞–≥ 4: –°–æ–∑–¥–∞–Ω–∏–µ –°–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –ê–∫–∫–∞—É–Ω—Ç–∞

–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –Ω—É–∂–Ω—ã –ø—Ä–∞–≤–∞, —á—Ç–æ–±—ã –ø–∏—Å–∞—Ç—å –ª–æ–≥–∏ –∏–ª–∏ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –¥—Ä—É–≥–∏–º —Å–µ—Ä–≤–∏—Å–∞–º.

```bash
# –°–æ–∑–¥–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç
yc iam service-account create --name agent-sa

# –ü–æ–ª—É—á–∞–µ–º –µ–≥–æ ID
yc iam service-account get agent-sa

# (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í—ã–¥–∞–µ–º –ø—Ä–∞–≤–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ), –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —á–∞—Å—Ç–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è.
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å–∫ Serverless Container

–¢–µ–ø–µ—Ä—å —Å–∞–º–æ–µ –≥–ª–∞–≤–Ω–æ–µ ‚Äî –∑–∞–ø—É—Å–∫–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –í–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –≤–∞—à–∏ –∫–ª—é—á–∏ –∏–∑ `.env`.

**–°–ø–æ—Å–æ–± –ê: –ß–µ—Ä–µ–∑ –ö–æ–Ω—Å–æ–ª—å (Web UI)** ‚Äî *–ü—Ä–æ—â–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞*
1.  –ó–∞–π–¥–∏—Ç–µ –≤ [Serverless Containers](https://console.cloud.yandex.ru/folders/ShouldBeYourFolder/containers).
2.  –ù–∞–∂–º–∏—Ç–µ **–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä**.
3.  –ò–º—è: `megaschool-agent`.
4.  –û–±—Ä–∞–∑: –í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞ (–æ–Ω —Ç–∞–º –ø–æ—è–≤–∏—Ç—Å—è –ø–æ—Å–ª–µ —à–∞–≥–∞ 3).
5.  **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
    *   –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –∫–ª—é—á–∏ –∏–∑ –≤–∞—à–µ–≥–æ `.env`:
        *   `GITHUB_APP_ID`
        *   `GITHUB_WEBHOOK_SECRET`
        *   `GITHUB_PRIVATE_KEY` (–≤–µ—Å—å –±–ª–æ–∫ —Ç–µ–∫—Å—Ç–∞)
        *   `LLM_API_KEY`
        *   `YC_FOLDER_ID`
6.  –ù–∞–∂–º–∏—Ç–µ **–°–æ–∑–¥–∞—Ç—å —Ä–µ–≤–∏–∑–∏—é**.

**–°–ø–æ—Å–æ–± –ë: –ß–µ—Ä–µ–∑ CLI (–û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π)**
–ú—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ —Å–∫—Ä–∏–ø—Ç `deploy_yandex.sh` (—Å–º. –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è), –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

### –®–∞–≥ 6: –ü–æ–ª—É—á–µ–Ω–∏–µ Webhook URL

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤—ã —É–≤–∏–¥–∏—Ç–µ **–°–ª—É–∂–µ–±–Ω—ã–π –¥–æ–º–µ–Ω** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `https://d4e5f6...apigw.yandexcloud.net`).

1.  –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —ç—Ç–æ—Ç URL.
2.  –ò–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∞—à–µ–≥–æ **GitHub App**.
3.  –í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–æ—Ç URL –≤ –ø–æ–ª–µ **Webhook URL**.
4.  –î–æ–±–∞–≤—å—Ç–µ –≤ –∫–æ–Ω—Ü–µ `/webhook` (–µ—Å–ª–∏ –≤–∞—à –∫–æ–¥ –æ–∂–∏–¥–∞–µ—Ç –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –ø—É—Ç—å).
    *   –ò—Ç–æ–≥–æ–≤—ã–π –≤–∏–¥: `https://d4e5f6...yandexcloud.net/webhook`

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–¢–µ–ø–µ—Ä—å –≤–∞—à –∞–≥–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–±–ª–∞–∫–µ –Ø–Ω–¥–µ–∫—Å–∞.
*   –û–Ω —Å–ø–∏—Ç, –∫–æ–≥–¥–∞ –Ω–µ—Ç –∑–∞–¥–∞—á (—ç–∫–æ–Ω–æ–º–∏—è –¥–µ–Ω–µ–≥).
*   –ü—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –∑–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã, –∫–æ–≥–¥–∞ GitHub –ø—Ä–∏—Å—ã–ª–∞–µ—Ç Webhook.
*   –õ–æ–≥–∏ –º–æ–∂–Ω–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –≤–∫–ª–∞–¥–∫–µ "–õ–æ–≥–∏" –≤ –∫–æ–Ω—Å–æ–ª–∏ –Ø–Ω–¥–µ–∫—Å.
